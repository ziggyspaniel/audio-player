<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Audio</title>
<style>
  :root { --z: 1; }
  html,body{margin:0;padding:0;background:transparent;font:14px/1.2 system-ui;overflow-x:hidden}
  .wrap{padding:6px 8px}
  .title{margin:0 0 6px;color:#111;font-weight:600;font-size:13px;display:none}
  .fallback{display:none;color:#900;margin:6px 0 0}   /* <-- hide by default */
  audio{
    width:calc(100% / var(--z));
    transform:scale(var(--z));
    transform-origin:left center;
  }
  @media (max-width:480px){
    .wrap{max-width:340px;margin:12px auto}
    :root{ --z:1.2 }
  }
</style>

<body>
  <div class="wrap">
    <div id="title" class="title"></div>
    <audio id="player" preload="metadata" controls controlslist="nodownload"></audio>
    <div id="fallback" class="fallback">No audio link provided.</div>
  </div>

<script>
  const qs = new URLSearchParams(location.search);
  const src   = qs.get('src');
  const title = qs.get('title');
  const zoom  = parseFloat(qs.get('z') || '') || null;

  if (zoom && zoom > 0.6 && zoom <= 1.8) {
    document.documentElement.style.setProperty('--z', zoom);
  }

  const audio = document.getElementById('player');
  const fb    = document.getElementById('fallback');

  if (title) {
    const t = document.getElementById('title');
    t.textContent = decodeURIComponent(title);
    t.style.display = 'block';
  }

  // autoplay ON by default; pass ?autoplay=0 to disable
  const autoplay = (qs.get('autoplay') ?? '1') !== '0';

  if (src && src.trim()) {
    audio.src = src.trim();
    fb.style.display = 'none';                // ensure hidden when src present
    if (autoplay) audio.play().catch(()=>{});
  } else {
    fb.style.display = 'block';
  }
</script>
</body>
</html>
